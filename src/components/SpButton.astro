---
import { getButtonClasses } from "@phcdevworks/spectre-ui";
import type { ButtonVariant, ButtonSize } from "@phcdevworks/spectre-ui";

type SpButtonElement = "button" | "a" | "span";

interface SpButtonProps {
  as?: SpButtonElement;
  variant?: ButtonVariant;
  size?: ButtonSize;
  fullWidth?: boolean;
  loading?: boolean;
  disabled?: boolean;
  class?: string;
  href?: string;
  target?: "_blank" | "_self" | "_parent" | "_top";
  rel?: string;
  type?: "button" | "submit" | "reset";
  [key: string]: any;
}

const {
  as = "button",
  variant = "primary",
  size = "md",
  fullWidth = false,
  loading = false,
  disabled = false,
  class: className,
  ...rest
} = Astro.props as SpButtonProps;

const classes = getButtonClasses({
  variant,
  size,
  fullWidth,
  loading,
  disabled,
});

const finalClass = [classes, className].filter(Boolean).join(" ");
const isDisabled = disabled || loading;

// make sure rest no longer has class
delete (rest as any).class;
---

{
  as === "a" ? (
    <a
      class={finalClass}
      aria-disabled={isDisabled ? "true" : undefined}
      {...rest}
    >
      <slot />
    </a>
  ) : as === "span" ? (
    <span
      class={finalClass}
      aria-disabled={isDisabled ? "true" : undefined}
      {...rest}
    >
      <slot />
    </span>
  ) : (
    <button
      class={finalClass}
      disabled={isDisabled}
      type={(rest as any).type ?? "button"}
      {...rest}
    >
      <slot />
    </button>
  )
}
